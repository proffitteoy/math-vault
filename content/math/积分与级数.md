---
obsidian-note-status:
  - colorful:onHold
---

>[!note] 引入
将区间 $[a, b]$ 分成 $n$ 个等宽的小区间，每个区间的宽度为 $\Delta x = \frac{b-a}{n}$。
在每个小区间内，任取一点 $x_i^*$ (可以是左端点、右端点或中点)。
以 $f(x_i^*)$ 为高，$\Delta x$ 为宽，构造一个矩形，其面积为 $f(x_i^*) \Delta x$。
将所有这些矩形的面积加起来，就得到了一个级数（求和），称为**黎曼和**：
$$ S_n = \sum_{i=1}^{n} f(x_i^*) \Delta x $$

当矩形的数量 $n$ 趋向于无穷大时（即 $\Delta x \to 0$），这个离散的和就变成了曲线下方的面积，也就是定积分。
$$ \lim_{n \to \infty} \sum_{i=1}^{n} f(x_i^*) \Delta x = \int_a^b f(x) dx $$

实际上黎曼和只是简单积分估计的一个特例
### 简单积分估计
对于一个求和复杂但积分简单的式子可以考虑积分估计：
$$\sum _{k=1}^n f(k) = \int_1^n f(x)dx+R_n$$
由此又转换成误差分析问题
#### 1.1 简单的积分估计脱胎于逐项估计

和的简单积分估计来自于逐项估计，其基本的想法是：如果函数$f$在实数轴的某个区间$I:= [a,b]$上是单调的，不妨假设是单调减少的，那么对于任意的子区间$[x_{k},x_{k+1}]\subseteq [a,b]$上，我们都有$$(x_{k+1}-x_k)f(x_{k+1})<\int_{x_k}^{x_{k+1}}f(x)\,dx$$如果我们再加上一些假设，令$\lfloor a \rfloor =x_1<\cdots<x_{n}=\lfloor b \rfloor$,并且假设函数的积分会更为简单一些，那么根据逐项估计的想法，新的和会更为简单，于是可以充当上界，那么上界即为$$\sum_{k=1}^{n-1}(x_{k+1}-x_k)f(x_{k+1})<\int_{\lfloor a \rfloor}^{\lfloor b\rfloor}f(x)\,dx$$如果写成差分的形式，上述方法告诉我们，如果$f$是单调的，并且$x_k$单调增加，那么我们可以用$f(x)$的和来控制$\sum \Delta x_k f(x_k)$的上界或者下界。

一些典型的例子：

* 对离散的和做积分估计：这个问题当中我们需要给出$$\sum_{k=1}^{n}(x_{k}-x_{k-1})(1-x_k)$$的上界估计，其中假设$0=x_0<x_1<...<x_n<1$。那么我们可以利用$f(x)=1-x$在$(0,1)$上的单调性以及非负性来做一个简单的积分估计，从而得到$$\sum_{k=1}^{n}(x_{k}-x_{k-1})(1-x_k)<\int_{0}^{x_n}f(x)\,dx <\int_{0}^{1}1-x \,dx = \frac{1}{2}$$
在放缩$(x_{k+1}-x_k)f(x_{k+1})<\int_{x_k}^{x_{k+1}}f(x)\,dx$当中如果我们对$x_k=k$,那么便成为了单纯对$f(k+1)$的积分放缩，此时再按照逐项估计的操作，两边求和，那么可以得到下面的结果:

>[!note] 和的简单积分估计
> 如果函数$f:[x,y]\to\mathbb{R}$是单调函数那么求和可以被积分估计(量化版本的):$$\sum_{n\in{\mathbb{Z}}:y\leq n\leq x}f(n)=\int_{y}^{x}f(t)\,dt+O(|f(x)|+|f(y)|)$$

* 这个结果的被求和对象$f(n)$可以看成是一个算术函数(定义域为整数，值域为复数)，于是这样的估计在数论当中是有价值的。不过因为精度不怎么高，只能作为粗略的处理手段。

不失一般性，假设函数不增：$$\begin{aligned}\int_{y}^{x}f(t)dt&=\int_{\lceil y\rceil}^{\lfloor x\rfloor}f(t)dt+\int_{y}^{\lceil y\rceil}f(t)dt+\int_{\lfloor x\rfloor}^{x}f(t)dt\\&\leq\sum_{n\in{\mathbb{Z}}:y\leq n\leq x-1}f(n)+\int_{y}^{\lceil y\rceil}f(t)dt+\int_{\lfloor x\rfloor}^{x}f(t)dt\\&\leq\sum_{n\in{\mathbb{Z}}:y\leq n\leq x}f(n)+\int_{y}^{\lceil y\rceil}f(t)dt\\&\leq\sum_{n\in{\mathbb{Z}}:y\leq n\leq x}f(n)+f(y)\end{aligned}$$反过来也有$$\int_{y}^{x}f(t)dt\geq\sum_{n\in{\mathbb{Z}}:y\leq n\leq x}f(n)+f(x)$$于是$$\sum_{n\in{\mathbb{Z}}:y\leq n\leq x}f(n)=\int_{y}^{x}f(t)dt+O\left(|f(x)|+|g(y)|\right)$$

> [!example] 例子1.1.1
> $f(t)=\log(t)$，那么:$$\sum_{1\leq n\le x}\log(n)=x\log(x)-x+O(\log(x+2))$$

但是**如果函数不是单调的而是震荡的，那么这个估计是不成立的**：

> [!example] 例子1.1.2
> $f(t):=|\cos(2\pi t)|$，那么和$$\sum_{y\leq n\le x}\cos(2\pi n)=O(x-y)$$可是如果无视"简单积分估计"对单调性的要求，直接根据上面的结果去强行做估计就会得出$O(1)$这样的错误的估计。

* 两种不同路径解决含参数和的估计问题：在这个问题当中我们的目标是得到$$S_n:=\sum_{i\leq n}\frac{1}{n+\sqrt{i}}$$的精度为$o\left(\frac{1}{\sqrt{n}}\right)$的估计。$S_n$的被求和对象是函数$f_n(x):=\frac{1}{n+\sqrt{x}}$，这是一个随着$x$增加而单调减少的函数，并且其在$[1,n]$上的定积分是简单的，可以利用Taylor展开轻易得到估计。最后我们利用上述公式中余项的表达，得知简单积分估计下，余项精度符合$o\left(\frac{1}{\sqrt{n}}\right)$，于是简单积分估计得到$$S_n=1-\frac{2}{3}\frac{1}{\sqrt{n}}+o\left(\frac{1}{\sqrt{n}}\right)$$
#### 1.2 基于简单积分估计的收敛判别法

> [!note] 级数收敛的积分判别法
> 如果说被求和函数$f:[M,+\infty)\to\mathbb{R}$可积(或者说广义黎曼积分存在)，并且函数单调减少到0,并且函数的积分$$\int_{M}^{\infty}f(t)\,dt $$是收敛的积分。那么级数$$\sum_{n\geq M}f(n)$$也是收敛的，反之亦然。

因为:$$f(n)\geq f(t)>f(n+1),t\in [n,n+1)$$于是两边同时积分，然后求和可以得到:$$f(N)+....\geq\int_{N}^{+\infty}f(t)\,dt\geq f(N+1)+....$$如果定义级数的余项，$A_N:=\sum_{n\geq N}f(n)$以及$I_N:=\int_{N}^{+\infty}f(t)\,dt$于是，$$I_N\leq A_N\leq I_N+f(N)$$也就是说，如果$I_N\to 0$,即积分是收敛的，并且$f(N)\to0$那么级数也是收敛的。

#### 1.3 利用函数的凸性做简单积分估计

> [!note] 利用函数凸性的简单积分估计
> 简单的积分估计本质上是一种逐项估计，我们利用函数的单调性，然后把函数在整数处的取值放缩为函数在长度为1的区间上的积分。按照相同的思路，有时候我们也可以利用函数的凸性来把函数逐项放缩为长度为1的区间上的积分。
> 
> 其主要参考的命题为：
> 
> 函数$g:[a,b]\to \mathbb{R}$是一个下凸的函数，那么它满足不等式$$\frac{g(a)+g(b)}{2}\geq \frac{1}{b-a}\int_{a}^b g(x)\,dx$$
> 证明的思路：可以选择对闭区间上的$x$做参数化，引入参数$t\in [0,1]$,于是$x = (1-t)a+tb$。于是利用凸性，对积分做逐项放缩$$g(x)=g((1-t)a+tb)\leq (1-t)g(a)+tg(b)$$这样就能得到上面的不等式。
> 
> 当函数$g(x)$在整数上取值的时候，不等式就变成了$$\frac{g(k)+g(k+1)}{2}\geq \int_{k}^{k+1} g(x)\,dx$$然后我们可以通过适当的对$k$求和从而形成对和的估计。

#### 1.4 未必能使用简单积分估计的情况

这里我们说的不是“例子1.1.2”当中的不满足单调性所以不能用的情况，而是满足所有条件，但是结果到不到预期的情况。这种情况具体来说可以分为:

* 积分真的是简单(或者至少是我们比较熟悉)的吗？

比如问题收敛的连乘积的上界估计与糖水不等式，部分积的上界估计与Gautschi不等式当中似乎被求和对象都是满足单调性的，是可以采取简单的积分估计的，但是其积分根本就不是一个简单的或者熟悉的结果，反而还需要对被积函数做放缩，那么为何不直接逐项估计?

* 简单的积分估计无法应付一些精度要求高的情况

比如对部分和渐近展开的常数项做估计中，虽然积分$$\int_{a}^{b}\frac{1}{\sqrt{t^2+t}}dt=2\text{arcsinh}(\sqrt{b})-2\text{arcsinh}(\sqrt{a})$$倒也算是我们比较熟悉的对象。不过如果我们真的用简单的积分估计去对问题中的$S_n$做估计，会发现因为其精度的缺陷导致问题的分析会异常复杂。